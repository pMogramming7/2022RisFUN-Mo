View(Asia.predominant.plot)
ratio.pre.driver <- ggplot(data_frame = predominant.driver, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver <- ggplot(data = as.data.frame(predominant.driver), aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver <- ggplot(data = predominant.driver, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
predominant.driver <- fct_count(factor(control_pivot$predominant.driver),sort = T)
predominant.driver$ratio <- predominant.driver$n/sum(predominant.driver$n)
ratio.pre.driver <- ggplot(data = predominant.driver, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver
predominant.drivers.America <- fct_count(factor(s.America$predominant.driver),sort = T)
ant.drivers.Africa <- fct_count(factor(Africa$predominant.driver),sort = T)
predominant.drivers.Africa$ratio <- predominant.drivers.Africa$n/sum(predominant.drivers.Africa$n)
predominant.drivers.America <- fct_count(factor(s.America$predominant.driver),sort = T)
predominant.drivers.America <- fct_count(factor(America$predominant.driver),sort = T)
predominant.drivers.America$ratio <- predominant.drivers.SAmerica$n/sum(predominant.drivers.SAmerica$n)
predominant.drivers.America$ratio <- predominant.drivers.America$n/sum(predominant.drivers.SAmerica$n)
predominant.drivers.America$ratio <- predominant.drivers.America$n/sum(predominant.drivers.America$n)
ratio.pre.driver.America <- ggplot(data = predominant.drivers.America, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in America")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver.America
ant.drivers.Africa <- fct_count(factor(Africa$predominant.driver),sort = T)
predominant.drivers.Africa$ratio <- predominant.drivers.Africa$n/sum(predominant.drivers.Africa$n)
predominant.drivers.Africa$ratio <- predominant.drivers.Africa$n/sum(predominant.drivers.Africa$n)
ant.drivers.Africa <- fct_count(factor(Africa$predominant.driver),sort = T)
predominant.drivers.Africa <- fct_count(factor(Africa$predominant.driver),sort = T)
predominant.drivers.Africa$ratio <- predominant.drivers.Africa$n/sum(predominant.drivers.Africa$n)
ratio.pre.drivers.Africa <- ggplot(data = predominant.drivers.Africa, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in Africa")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.drivers.Africa
predominant.drivers.AO
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.Asia$n/sum(predominant.drivers.Asia$n)
ratio.pre.drivers.AO <- ggplot(data = predominant.drivers.Asia, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in Asia and Oceania")+
labs(x="Predominant drivers",y="Ratio")
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.Asia$n/sum(predominant.drivers.Asia$n)
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.Asia$n/sum(predominant.drivers.Asia$n)
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.Asia$n/sum(predominant.drivers.AO$n)
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.AO$n/sum(predominant.drivers.AO$n)
ratio.pre.drivers.AO <- ggplot(data = predominant.drivers.AO, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in Asia and Oceania")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.drivers.AO
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia"))
as.tibble(mds.predominant$points)%>%
bind_cols(Sample=presence.pre.drivers$sampleid)%>%
ggplot()+
geom_point(aes(x=V1,y=V2,col=control_pivot$region))
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
Asia.predominant.plot <- ggplot(data=world)+  #Asia
geom_sf()+
coord_sf(xlim=c(63,160),ylim=c(-35,40),expand=F)+
labs(x="Longitude",y="Latitude")+
geom_point(data=control_pivot,aes(x=x,y=y,colour=factor(predominant.driver)),
alpha=0.9)+
ggtitle("Predominant drivers of forest loss in Asia and Oceania")+
scale_color_brewer(name="Predominant drivers",palette= "Set1")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(size = 8),
legend.text = element_text(size=7))
Asia.predominant.plot
Asia <- filter(control_pivot, x<=160 & x>=63)
predominant.driver <- fct_count(factor(control_pivot$predominant.driver),sort = T)
predominant.driver$ratio <- predominant.driver$n/sum(predominant.driver$n)
ratio.pre.driver <- ggplot(data = predominant.driver, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
?fviz_eig
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
abline(predominant.pca2, h=1, col="blue")
View(presence.pre.drivers)
pca <- prcomp(formula = ~ [:4-12],
pca <- prcomp(formula = [:4-12],
?pca
?? prcomp
? prcomp
pcaG <- prcomp(data = presence.pre.drivers,
scale = TRUE)
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F) + abline(h=1, col="blue")
fviz_eig(predominant.pca2)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F) + abline(h=1, col="blue")
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95)
?fviz_pca_biplot
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95,labelsize=3)+
theme(text = element_text(size = 7.5),
axis.title = element_text(size = 7.5),
axis.text = element_text(size = 7.5), title = "PCA - Predominant drivers in three regions")
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"South America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95,labelsize=3, title = "PCA - Predominant drivers in three regions")+
theme(text = element_text(size = 7.5),
axis.title = element_text(size = 7.5),
axis.text = element_text(size = 7.5))
knitr::opts_chunk$set(echo = TRUE)
countries <- function(points)
{
countriesSP <- getMap(resolution='low')
pointsSP = SpatialPoints(points, proj4string=CRS(proj4string(countriesSP)))
indices = over(pointsSP, countriesSP)
indices$ADMIN  #returns country name
}
points <- data.frame(lon=control_pivot$x,lat=control_pivot$y)
control_pivot$country <- countries(points)
library(ggplot2)
library(ggmap)
library(rnaturalearth)
library(tidyverse)
library(forcats)
library(vegan)
library(RColorBrewer) # color tool
library(ade4) # PCA plot
library(factoextra) # PCA plot
library(magrittr) #PCA plot
library(sp)
library(rworldmap)
knitr::opts_chunk$set(echo = TRUE)
control <- read.csv("D:/R_WD/Git linked/2022RisFUN-Mo/Final present/Data_fp/ILUC_DARE_controls_x_y.csv")
library(ggplot2)
library(ggmap)
library(rnaturalearth)
library(tidyverse)
library(forcats)
library(vegan)
library(RColorBrewer) # color tool
library(ade4) # PCA plot
library(factoextra) # PCA plot
library(magrittr) #PCA plot
library(sp)
library(rworldmap)
control <- control%>%arrange(answer)
control_pivot <- control%>%pivot_wider(id_cols = c(sampleid,x,y),
names_from = step,values_from = answer,
values_fn = function(x)paste(x,collapse = ","))
control_pivot <- rename(control_pivot, architecture=step3,predominant.driver=step1,other.drivers=step2)
world <- ne_countries(scale = "medium", returnclass = "sf")
predominant.driver <- ggplot(data=world)+
geom_sf()+
coord_sf(expand=F)+
labs(x="Longitude",y="Latitude")+
geom_point(data=control_pivot,aes(x=x,y=y,colour=factor(predominant.driver)),
alpha=0.7,size=0.7)+
ggtitle("Predominant drivers of global tropical forest loss")+
scale_color_brewer(name="Predominant drivers",palette= "Set1")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(size = 8),
legend.text = element_text(size=7))
predominant.driver
America.predominant.plot <- ggplot(data=world)+  #south America
geom_sf()+
coord_sf(xlim=c(-120,-20),ylim=c(-45,40),expand=F)+
labs(x="Longitude",y="Latitude")+
geom_point(data=control_pivot,aes(x=x,y=y,colour=factor(predominant.driver)),
alpha=0.9)+
ggtitle("Predominant drivers of forest loss in America")+
scale_color_brewer(name="Predominant drivers",palette= "Set1")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(size = 8),
legend.text = element_text(size=7))
America.predominant.plot
America <- filter(control_pivot, x<=-20 & x>=-120)
Africa.predominant.plot <- ggplot(data=world)+  #Africa
geom_sf()+
coord_sf(xlim=c(-20,55),ylim=c(-35,23.5),expand=F)+
labs(x="Longitude",y="Latitude")+
geom_point(data=control_pivot,aes(x=x,y=y,colour=factor(predominant.driver)),
alpha=0.9)+
ggtitle("Predominant drivers of forest loss in Africa")+
scale_color_brewer(name="Predominant drivers",palette= "Set1")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(size = 8),
legend.text = element_text(size=7))
Africa.predominant.plot
Africa <- filter(control_pivot, x<=60 & x>=-20)
Asia.predominant.plot <- ggplot(data=world)+  #Asia
geom_sf()+
coord_sf(xlim=c(63,160),ylim=c(-35,40),expand=F)+
labs(x="Longitude",y="Latitude")+
geom_point(data=control_pivot,aes(x=x,y=y,colour=factor(predominant.driver)),
alpha=0.9)+
ggtitle("Predominant drivers of forest loss in Asia and Oceania")+
scale_color_brewer(name="Predominant drivers",palette= "Set1")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(size = 8),
legend.text = element_text(size=7))
Asia.predominant.plot
Asia <- filter(control_pivot, x<=160 & x>=63)
predominant.driver <- fct_count(factor(control_pivot$predominant.driver),sort = T)
predominant.driver$ratio <- predominant.driver$n/sum(predominant.driver$n)
ratio.pre.driver <- ggplot(data = predominant.driver, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_manual(name="Predominant drivers",values= c(2:10))+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tropical forest loss drivers in global")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver
predominant.drivers.America <- fct_count(factor(America$predominant.driver),sort = T)
predominant.drivers.America$ratio <- predominant.drivers.America$n/sum(predominant.drivers.America$n)
ratio.pre.driver.America <- ggplot(data = predominant.drivers.America, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in America")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.driver.America
predominant.drivers.Africa <- fct_count(factor(Africa$predominant.driver),sort = T)
predominant.drivers.Africa$ratio <- predominant.drivers.Africa$n/sum(predominant.drivers.Africa$n)
ratio.pre.drivers.Africa <- ggplot(data = predominant.drivers.Africa, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in Africa")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.drivers.Africa
predominant.drivers.AO <- fct_count(factor(Asia$predominant.driver),sort = T)
predominant.drivers.AO$ratio <- predominant.drivers.AO$n/sum(predominant.drivers.AO$n)
ratio.pre.drivers.AO <- ggplot(data = predominant.drivers.AO, aes(x=f,y=ratio,fill=f))+
geom_bar(stat = "identity")+
scale_fill_brewer(name="Predominant drivers",palette = "Set1")+
geom_text(aes(label=paste(100*round(ratio,3),"%")),vjust=-0.3,size=3)+
theme_bw()+
theme(axis.text.x = element_blank())+
ggtitle("Ratio of predominant tree loss driver in Asia and Oceania")+
labs(x="Predominant drivers",y="Ratio")
ratio.pre.drivers.AO
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:3)] <-ifelse(is.na(presence.pre.drivers[,-(1:3)]),0,1)
control_pivot$region <- ifelse(control_pivot$x>=-120 & control_pivot$x<=-20,"America",
ifelse(control_pivot$x>=-20 & control_pivot$x<=60,"Africa","Asia and Oceania"))
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:3)],scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5, addEllipses = T,ellipse.level=0.95,labelsize=3, title = "PCA - Predominant drivers in three regions")+
theme(text = element_text(size = 7.5),
axis.title = element_text(size = 7.5),
axis.text = element_text(size = 7.5))
countries <- function(points)
{
countriesSP <- getMap(resolution='low')
pointsSP = SpatialPoints(points, proj4string=CRS(proj4string(countriesSP)))
indices = over(pointsSP, countriesSP)
indices$ADMIN  #returns country name
}
points <- data.frame(lon=control_pivot$x,lat=control_pivot$y)
control_pivot$country <- countries(points)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y,region,country),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:5)] <-ifelse(is.na(presence.pre.drivers[,-(1:5)]),0,1)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
View(ratio.pre.driver)
View(presence.pre.drivers)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
presence.pre.drivers[,-(1:5)] <-ifelse(is.na(presence.pre.drivers[,-(1:5)]),0,1)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y,region,country),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:5)] <-ifelse(is.na(presence.pre.drivers[,-(1:5)]),0,1)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
as.tibble(mds.predominant$points)%>%
bind_cols(Sample=presence.pre.drivers$sampleid)%>%
ggplot()+
geom_point(aes(x=V1,y=V2,col=control_pivot$region))
as.tibble(mds.predominant$points)%>%
bind_cols(Sample=presence.pre.drivers$sampleid)%>%
ggplot()+
geom_point(aes(x=V1,y=V2,col=control_pivot$region))
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
presence.pre.drivers.nmds <- metaMDS(presence.pre.drivers[,-(1:3)],distance = "bray",trymax = 1)
countries <- function(points)
{
countriesSP <- getMap(resolution='low')
pointsSP = SpatialPoints(points, proj4string=CRS(proj4string(countriesSP)))
indices = over(pointsSP, countriesSP)
indices$ADMIN  #returns country name
}
points <- data.frame(lon=control_pivot$x,lat=control_pivot$y)
control_pivot$country <- countries(points)
presence.pre.drivers <- control_pivot%>%
mutate(presence=1)%>%
pivot_wider(id_cols = c(sampleid,x,y,region,country),names_from = predominant.driver,values_from = presence)
presence.pre.drivers[,-(1:5)] <-ifelse(is.na(presence.pre.drivers[,-(1:5)]),0,1)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
mds.predominant <- presence.pre.drivers%>%select(-(1:3))%>%
vegdist(method = "bray")%>%
cmdscale(eig=T,k=2)
#沒用國家去分
predominant.pca2 <- dudi.pca(presence.pre.drivers[-(1:5)],
scannf=F,nf=6,scale = F)
fviz_eig(predominant.pca2)
get_eig(predominant.pca2)
fviz_pca_biplot(predominant.pca2,repel = T,habillage=control_pivot$region,
alpha.ind=0.5,addEllipses = T,ellipse.level=0.95,
labelsize=3)+
theme(text = element_text(size = 7.5),
axis.title = element_text(size = 7.5),
axis.text = element_text(size = 7.5))
predominant.pca3 <- dist.binary(presence.pre.drivers[-(1:3)],method = 1)
#用國家去分
presence.pre.drivers.na.omit <- presence.pre.drivers%>%na.omit(country)
presence.pre.drivers.countries <- presence.pre.drivers.na.omit%>%
group_by(country)%>%
summarise(across("Pasture":"Mining and crude oil extraction",.fns=sum))
#percentage
presence.pre.drivers.countries[-1] <- presence.pre.drivers.countries[-1]/rowSums(presence.pre.drivers.countries[-1])
countries.continent <- control_pivot%>% #國家跟洲對照表
select(country,region)%>%
unique()%>%
na.omit()%>%
arrange(country)
predominant.pca4 <- dudi.pca(presence.pre.drivers.countries[,-1],
scannf=F,nf=9,scale = F)
fviz_eig(predominant.pca4)
get_eig(predominant.pca4)
fviz_pca_biplot(predominant.pca4,repel = T,
alpha.ind=0.5,
labelsize=3,habillage = countries.continent$region,
addEllipses = T,ellipse.level=0.95)+
theme(text = element_text(size = 7.5),
axis.title = element_text(size = 7.5),
axis.text = element_text(size = 7.5))
